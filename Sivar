--[[
    ìœ ë‹ˆë²„ìŠ¤ (Universe) - Rayfield GUI (ìµœì¢… ì—…ê·¸ë ˆì´ë“œ ë²„ì „)
    - PCLD: ìƒëŒ€ë°© ìœ„ì¹˜ì— ID í‘œì‹œ
    - ì†ë„ ì¡°ì ˆ: ë” ì„¬ì„¸í•˜ê³  ì•ˆì •ì ìœ¼ë¡œ
    - í”Œë ˆì´ì–´ í…”ë ˆí¬íŠ¸: 1ì´ˆ ë”œë ˆì´ + ì‹œê°ì  íš¨ê³¼
]]

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- ìœˆë„ìš° ìƒì„±
local Window = Rayfield:CreateWindow({
    Name = "ìœ ë‹ˆë²„ìŠ¤ (Universe)",
    LoadingTitle = "ìœ ë‹ˆë²„ìŠ¤ ë¡œë”© ì¤‘...",
    LoadingSubtitle = "by Rayfield",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "UniverseHub",
        FileName = "Config"
    },
    ToggleUIKeybind = "K",
    KeySystem = false,
})

--============================================================================--
-- ì „ì—­ ë³€ìˆ˜ ì„¤ì •
--============================================================================--
local player = game.Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

--============================================================================--
-- 1. ë©”ì¸ íƒ­ (í•µì‹¬ ê¸°ëŠ¥)
--============================================================================--
local MainTab = Window:CreateTab("ë©”ì¸", 4483362458)
local MainSection = MainTab:CreateSection("ì´ë™ ê´€ë ¨ ê¸°ëŠ¥")

-- í™˜ì˜ ë©”ì‹œì§€
Rayfield:Notify({
    Title = "ìœ ë‹ˆë²„ìŠ¤ ì‹¤í–‰ë¨",
    Content = "Kí‚¤ë¥¼ ëˆŒëŸ¬ UIë¥¼ í† ê¸€í•˜ì„¸ìš”.",
    Duration = 5,
})

------------------------------------------------------------------------
-- 1.1 ì†ë„ ì¡°ì ˆ ìŠ¬ë¼ì´ë” (ë” ì„¬ì„¸í•˜ê²Œ ê°œì„ )
------------------------------------------------------------------------
local currentSpeed = 16
local speedHumanoid = nil
local speedConnection = nil

-- ì†ë„ ì ìš© í•¨ìˆ˜ (ì•ˆì „í•˜ê²Œ)
local function applySpeed(speedValue)
    if player.Character then
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = speedValue
            return true
        end
    end
    return false
end

-- ì†ë„ ìŠ¬ë¼ì´ë” ìƒì„± (ë” ì„¸ë¶„í™”ëœ ì¡°ì ˆ)
MainTab:CreateSlider({
    Name = "ì†ë„ ì¡°ì ˆ (WalkSpeed) - 0.1 ë‹¨ìœ„ ì¡°ì ˆ",
    Range = {16, 500},
    Increment = 0.1,  -- 0.1 ë‹¨ìœ„ë¡œ ë” ì„¬ì„¸í•˜ê²Œ ì¡°ì ˆ
    Suffix = "Speed",
    CurrentValue = 16,
    Flag = "SpeedSlider",
    Callback = function(value)
        currentSpeed = value
        applySpeed(value)
    end,
})

-- í˜„ì¬ ì†ë„ í‘œì‹œ ë ˆì´ë¸”
local speedLabel = MainTab:CreateLabel("í˜„ì¬ ì†ë„: 16.0")

-- ì†ë„ ì‹¤ì‹œê°„ í‘œì‹œ ì—…ë°ì´íŠ¸
game:GetService("RunService").Heartbeat:Connect(function()
    if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
        local currentWS = player.Character.Humanoid.WalkSpeed
        speedLabel:Set("í˜„ì¬ ì†ë„: " .. string.format("%.1f", currentWS))
    end
end)

-- ìºë¦­í„° ë¦¬ìŠ¤í° ì²˜ë¦¬ (ë” ì•ˆì •ì ìœ¼ë¡œ)
local function onCharacterAdded(character)
    -- ìºë¦­í„°ê°€ ì™„ì „íˆ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
    local humanoid = character:WaitForChild("Humanoid", 5)
    if humanoid then
        -- ì•½ê°„ì˜ ì§€ì—° í›„ ì†ë„ ì ìš© (ê²Œì„ì´ ë®ì–´ì“°ëŠ” ê²ƒ ë°©ì§€)
        task.wait(0.5)
        humanoid.WalkSpeed = currentSpeed
        
        -- ì§€ì†ì ìœ¼ë¡œ ì†ë„ ê°ì‹œ (ê²Œì„ì´ ê°•ì œë¡œ ë³€ê²½í•  ê²½ìš° ëŒ€ë¹„)
        if speedConnection then
            speedConnection:Disconnect()
        end
        
        speedConnection = humanoid:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
            if humanoid.WalkSpeed ~= currentSpeed and currentSpeed > 16 then
                -- ê²Œì„ì´ ì†ë„ë¥¼ ë³€ê²½í•˜ë ¤ê³  í•˜ë©´ ë‹¤ì‹œ ìš°ë¦¬ ì†ë„ë¡œ ë˜ëŒë¦¼
                task.wait(0.1)
                if humanoid.WalkSpeed ~= currentSpeed then
                    humanoid.WalkSpeed = currentSpeed
                end
            end
        end)
    end
end

-- ìºë¦­í„° ì¶”ê°€ ì´ë²¤íŠ¸ ì—°ê²°
player.CharacterAdded:Connect(onCharacterAdded)

-- ì´ˆê¸° ìºë¦­í„° ì²˜ë¦¬
if player.Character then
    onCharacterAdded(player.Character)
end

------------------------------------------------------------------------
-- 1.2 ì í”„ë ¥ ì¡°ì ˆ (ë” ì„¬ì„¸í•˜ê²Œ)
------------------------------------------------------------------------
local currentJumpPower = 50

MainTab:CreateSlider({
    Name = "ì í”„ë ¥ ì¡°ì ˆ (JumpPower) - 0.5 ë‹¨ìœ„ ì¡°ì ˆ",
    Range = {50, 300},
    Increment = 0.5,
    Suffix = "Power",
    CurrentValue = 50,
    Flag = "JumpSlider",
    Callback = function(value)
        currentJumpPower = value
        if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
            player.Character.Humanoid.JumpPower = value
        end
    end,
})

-- ì í”„ë ¥ ì‹¤ì‹œê°„ í‘œì‹œ
local jumpLabel = MainTab:CreateLabel("í˜„ì¬ ì í”„ë ¥: 50.0")

RunService.Heartbeat:Connect(function()
    if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
        local currentJP = player.Character.Humanoid.JumpPower
        jumpLabel:Set("í˜„ì¬ ì í”„ë ¥: " .. string.format("%.1f", currentJP))
    end
end)

------------------------------------------------------------------------
-- 1.3 ë¬´í•œ ì í”„
------------------------------------------------------------------------
local InfiniteJumpEnabled = false
local JumpConnection = nil

MainTab:CreateToggle({
    Name = "ë¬´í•œ ì í”„",
    CurrentValue = false,
    Flag = "InfiniteJumpToggle",
    Callback = function(state)
        InfiniteJumpEnabled = state

        if InfiniteJumpEnabled then
            JumpConnection = UIS.JumpRequest:Connect(function()
                if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
                    player.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                end
            end)
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë¬´í•œ ì í”„ ON", Duration = 2 })
        else
            if JumpConnection then
                JumpConnection:Disconnect()
                JumpConnection = nil
            end
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë¬´í•œ ì í”„ OFF", Duration = 2 })
        end
    end,
})

------------------------------------------------------------------------
-- 1.4 ë²½ëš«ê¸° (Noclip)
------------------------------------------------------------------------
local NoclipEnabled = false
local NoclipConnection = nil

MainTab:CreateToggle({
    Name = "ë²½ëš«ê¸° (Noclip)",
    CurrentValue = false,
    Flag = "NoclipToggle",
    Callback = function(state)
        NoclipEnabled = state

        if NoclipEnabled then
            NoclipConnection = RunService.Stepped:Connect(function()
                if player.Character then
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") and part.CanCollide == true then
                            part.CanCollide = false
                        end
                    end
                end
            end)
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë²½ëš«ê¸° ON", Duration = 2 })
        else
            if NoclipConnection then
                NoclipConnection:Disconnect()
                NoclipConnection = nil
                
                if player.Character then
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = true
                        end
                    end
                end
            end
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë²½ëš«ê¸° OFF", Duration = 2 })
        end
    end,
})

------------------------------------------------------------------------
-- 1.5 PCLD - ìƒëŒ€ë°© ìœ„ì¹˜ ID í‘œì‹œ (ë¹¨ê°„ì  ëŒ€ì‹  IDë¡œ)
------------------------------------------------------------------------
local PCLDSection = MainTab:CreateSection("PCLD - ìƒëŒ€ë°© ID í‘œì‹œ")

local PCLDEnabled = false
local PCLDMarkers = {}  -- ID ë§ˆì»¤ ì €ì¥ í…Œì´ë¸”
local PCLDConnection = nil

-- ID ë§ˆì»¤ ìƒì„± í•¨ìˆ˜ (ë¹¨ê°„ì  ëŒ€ì‹  ID í…ìŠ¤íŠ¸)
local function createIDMarker(targetPlayer)
    if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        return nil
    end
    
    -- ë§ˆì»¤ë¥¼ ìœ„í•œ Part (ê±°ì˜ íˆ¬ëª…í•˜ê²Œ)
    local marker = Instance.new("Part")
    marker.Name = "PCLD_Marker_" .. targetPlayer.Name
    marker.Size = Vector3.new(1, 1, 1)
    marker.Transparency = 1  -- ì™„ì „ íˆ¬ëª…
    marker.Anchored = true
    marker.CanCollide = false
    marker.Parent = workspace
    
    -- ID í‘œì‹œë¥¼ ìœ„í•œ BillboardGui
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "IDTag"
    billboard.Size = UDim2.new(0, 150, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = marker
    
    -- ë°°ê²½
    local background = Instance.new("Frame")
    background.Size = UDim2.new(1, 0, 1, 0)
    background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    background.BackgroundTransparency = 0.3
    background.BorderSizePixel = 2
    background.BorderColor3 = Color3.fromRGB(255, 100, 100)
    background.Parent = billboard
    
    -- ID í‘œì‹œ í…ìŠ¤íŠ¸
    local idLabel = Instance.new("TextLabel")
    idLabel.Size = UDim2.new(1, 0, 0.5, 0)
    idLabel.Position = UDim2.new(0, 0, 0, 0)
    idLabel.BackgroundTransparency = 1
    idLabel.Text = "ID: " .. targetPlayer.UserId
    idLabel.TextColor3 = Color3.fromRGB(255, 200, 200)
    idLabel.TextStrokeTransparency = 0.3
    idLabel.TextStrokeColor3 = Color3.fromRGB(255, 0, 0)
    idLabel.Font = Enum.Font.GothamBold
    idLabel.TextSize = 18
    idLabel.Parent = background
    
    -- ì´ë¦„ í‘œì‹œ í…ìŠ¤íŠ¸ (ì‘ê²Œ)
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    nameLabel.Position = UDim2.new(0, 0, 0.5, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = targetPlayer.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextStrokeTransparency = 0
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.Font = Enum.Font.Gotham
    nameLabel.TextSize = 14
    nameLabel.Parent = background
    
    return marker
end

-- ëª¨ë“  í”Œë ˆì´ì–´ì˜ ìœ„ì¹˜ì— ID ë§ˆì»¤ ìƒì„±
local function updatePCLDMarkers()
    -- ê¸°ì¡´ ë§ˆì»¤ ì œê±°
    for _, marker in pairs(PCLDMarkers) do
        if marker then
            marker:Destroy()
        end
    end
    PCLDMarkers = {}
    
    -- ëª¨ë“  í”Œë ˆì´ì–´ ìˆœíšŒ (ìì‹  ì œì™¸)
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local marker = createIDMarker(plr)
            if marker then
                PCLDMarkers[plr] = marker
            end
        end
    end
end

-- ë§ˆì»¤ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
local function moveMarkersToPlayers()
    for plr, marker in pairs(PCLDMarkers) do
        if plr and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            marker.CFrame = plr.Character.HumanoidRootPart.CFrame
        else
            -- í”Œë ˆì´ì–´ê°€ ì—†ì–´ì¡Œìœ¼ë©´ ë§ˆì»¤ ì œê±°
            if marker then
                marker:Destroy()
            end
            PCLDMarkers[plr] = nil
        end
    end
    
    -- ìƒˆë¡œ ì¶”ê°€ëœ í”Œë ˆì´ì–´ í™•ì¸
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player and not PCLDMarkers[plr] and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local marker = createIDMarker(plr)
            if marker then
                PCLDMarkers[plr] = marker
            end
        end
    end
end

-- PCLD í† ê¸€ ìƒì„±
MainTab:CreateToggle({
    Name = "PCLD - ìƒëŒ€ë°© ID í‘œì‹œ",
    CurrentValue = false,
    Flag = "PCLDToggle",
    Callback = function(state)
        PCLDEnabled = state
        
        if PCLDEnabled then
            -- ì´ˆê¸° ë§ˆì»¤ ìƒì„±
            updatePCLDMarkers()
            
            -- ì‹¤ì‹œê°„ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ì—°ê²°
            PCLDConnection = RunService.Heartbeat:Connect(function()
                if PCLDEnabled then
                    moveMarkersToPlayers()
                end
            end)
            
            Rayfield:Notify({ Title = "PCLD", Content = "ìƒëŒ€ë°© ID í‘œì‹œ ON", Duration = 2 })
        else
            -- PCLD ë¹„í™œì„±í™”
            if PCLDConnection then
                PCLDConnection:Disconnect()
                PCLDConnection = nil
            end
            
            -- ëª¨ë“  ë§ˆì»¤ ì œê±°
            for _, marker in pairs(PCLDMarkers) do
                if marker then
                    marker:Destroy()
                end
            end
            PCLDMarkers = {}
            
            Rayfield:Notify({ Title = "PCLD", Content = "ìƒëŒ€ë°© ID í‘œì‹œ OFF", Duration = 2 })
        end
    end,
})

-- í”Œë ˆì´ì–´ ì¶”ê°€/ì œê±° ì´ë²¤íŠ¸ ì²˜ë¦¬
Players.PlayerAdded:Connect(function(newPlayer)
    if PCLDEnabled and newPlayer ~= player then
        -- ë‹¤ìŒ ì—…ë°ì´íŠ¸ ì£¼ê¸°ì— ìë™ ìƒì„±ë¨
    end
end)

Players.PlayerRemoving:Connect(function(leavingPlayer)
    if PCLDEnabled and PCLDMarkers[leavingPlayer] then
        PCLDMarkers[leavingPlayer]:Destroy()
        PCLDMarkers[leavingPlayer] = nil
    end
end)

--============================================================================--
-- 2. í…”ë ˆí¬íŠ¸ íƒ­ (1ì´ˆ ë”œë ˆì´ í…”ë ˆí¬íŠ¸)
--============================================================================--
local TeleportTab = Window:CreateTab("í…”ë ˆí¬íŠ¸", 4483362458)
local TeleportSection = TeleportTab:CreateSection("í”Œë ˆì´ì–´ì—ê²Œ í…”ë ˆí¬íŠ¸ (1ì´ˆ ë”œë ˆì´)")

-- í”Œë ˆì´ì–´ ì„ íƒ ë“œë¡­ë‹¤ìš´ì„ ìœ„í•œ ë³€ìˆ˜
local selectedPlayer = nil
local playerList = {}
local isTeleporting = false

-- í”Œë ˆì´ì–´ ëª©ë¡ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
local function updatePlayerList()
    playerList = {}
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then  -- ìì‹  ì œì™¸
            table.insert(playerList, plr.Name)
        end
    end
    return playerList
end

-- ì´ˆê¸° í”Œë ˆì´ì–´ ëª©ë¡
local initialList = updatePlayerList()

-- í”Œë ˆì´ì–´ ì„ íƒ ë“œë¡­ë‹¤ìš´
local playerDropdown = TeleportTab:CreateDropdown({
    Name = "í”Œë ˆì´ì–´ ì„ íƒ",
    Options = initialList,
    CurrentOption = "",
    MultipleOptions = false,
    Flag = "PlayerSelectDropdown",
    Callback = function(option)
        -- ì„ íƒëœ í”Œë ˆì´ì–´ ì°¾ê¸°
        for _, plr in ipairs(Players:GetPlayers()) do
            if plr.Name == option then
                selectedPlayer = plr
                Rayfield:Notify({
                    Title = "í”Œë ˆì´ì–´ ì„ íƒ",
                    Content = plr.Name .. "ë‹˜ì´ ì„ íƒë¨",
                    Duration = 1.5
                })
                break
            end
        end
    end,
})

-- ìƒíƒœ í‘œì‹œ ë ˆì´ë¸”
local statusLabel = TeleportTab:CreateLabel("ìƒíƒœ: ëŒ€ê¸° ì¤‘")

-- í…”ë ˆí¬íŠ¸ í•¨ìˆ˜ (1ì´ˆ ë”œë ˆì´ + íš¨ê³¼)
local function teleportToPlayer(targetPlayer)
    if isTeleporting then
        Rayfield:Notify({
            Title = "ê²½ê³ ",
            Content = "ì´ë¯¸ í…”ë ˆí¬íŠ¸ ì¤‘ì…ë‹ˆë‹¤!",
            Duration = 2
        })
        return
    end
    
    if not targetPlayer then
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = "ë¨¼ì € í”Œë ˆì´ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”!",
            Duration = 2
        })
        return
    end
    
    if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = targetPlayer.Name .. "ë‹˜ì˜ ìºë¦­í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
            Duration = 2
        })
        return
    end
    
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = "ë‚´ ìºë¦­í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",
            Duration = 2
        })
        return
    end
    
    -- í…”ë ˆí¬íŠ¸ ì‹œì‘
    isTeleporting = true
    
    -- 1ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´ ë° íš¨ê³¼
    for i = 1, 10 do
        local countdownValue = (11 - i) / 10
        statusLabel:Set("ìƒíƒœ: " .. string.format("%.1f", countdownValue) .. "ì´ˆ í›„ í…”ë ˆí¬íŠ¸...")
        
        -- í™”ë©´ í”ë“¤ë¦¼ íš¨ê³¼ (ì ì  ê°•í•˜ê²Œ)
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local randomOffset = Vector3.new(
                math.random(-10, 10) / 10 * (1 - countdownValue),
                math.random(-10, 10) / 10 * (1 - countdownValue),
                math.random(-10, 10) / 10 * (1 - countdownValue)
            )
            player.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame + randomOffset
        end
        
        -- íš¨ê³¼ìŒ (ì„ íƒì‚¬í•­, ê²Œì„ì— ë”°ë¼ ë‹¤ë¦„)
        -- ê²Œì„ì— ë”°ë¼ ì‚¬ìš´ë“œ ì„œë¹„ìŠ¤ ì‚¬ìš© ê°€ëŠ¥
        
        task.wait(0.1)  -- 0.1ì´ˆì”© 10ë²ˆ = ì´ 1ì´ˆ
    end
    
    -- í…”ë ˆí¬íŠ¸ ì‹¤í–‰
    if targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local targetCF = targetPlayer.Character.HumanoidRootPart.CFrame
        player.Character.HumanoidRootPart.CFrame = targetCF + Vector3.new(0, 5, 0)
        
        -- í…”ë ˆí¬íŠ¸ ì™„ë£Œ íš¨ê³¼ (ë¹›ë‚˜ëŠ” íš¨ê³¼)
        local effectPart = Instance.new("Part")
        effectPart.Size = Vector3.new(5, 5, 5)
        effectPart.Position = player.Character.HumanoidRootPart.Position
        effectPart.BrickColor = BrickColor.new("Bright blue")
        effectPart.Material = Enum.Material.Neon
        effectPart.Transparency = 0.5
        effectPart.Anchored = true
        effectPart.CanCollide = false
        effectPart.Parent = workspace
        
        -- ì„œì„œíˆ ì‚¬ë¼ì§€ëŠ” íš¨ê³¼
        for i = 1, 10 do
            effectPart.Transparency = effectPart.Transparency + 0.05
            effectPart.Size = effectPart.Size + Vector3.new(0.5, 0.5, 0.5)
            task.wait(0.05)
        end
        
        effectPart:Destroy()
        
        Rayfield:Notify({
            Title = "í…”ë ˆí¬íŠ¸ ì™„ë£Œ!",
            Content = targetPlayer.Name .. "ë‹˜ì—ê²Œ ì´ë™í–ˆìŠµë‹ˆë‹¤.",
            Duration = 3
        })
    else
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = "í…”ë ˆí¬íŠ¸ ì‹¤íŒ¨: ëŒ€ìƒ ìºë¦­í„°ê°€ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.",
            Duration = 2
        })
    end
    
    statusLabel:Set("ìƒíƒœ: ëŒ€ê¸° ì¤‘")
    isTeleporting = false
end

-- ì„ íƒëœ í”Œë ˆì´ì–´ì—ê²Œ í…”ë ˆí¬íŠ¸ ë²„íŠ¼
TeleportTab:CreateButton({
    Name = "ğŸ¯ ì„ íƒí•œ í”Œë ˆì´ì–´ì—ê²Œ í…”ë ˆí¬íŠ¸ (1ì´ˆ í›„ ì´ë™)",
    Callback = function()
        teleportToPlayer(selectedPlayer)
    end,
})

-- ë¹ ë¥¸ í…”ë ˆí¬íŠ¸ë¥¼ ìœ„í•œ í‚¤ë°”ì¸ë“œ (ì„ íƒì‚¬í•­)
local keybindLabel = TeleportTab:CreateLabel("ë‹¨ì¶•í‚¤: T í‚¤ë¥¼ ëˆŒëŸ¬ ì„ íƒëœ í”Œë ˆì´ì–´ì—ê²Œ ì¦‰ì‹œ í…”ë ˆí¬íŠ¸")

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.T then
        if selectedPlayer then
            teleportToPlayer(selectedPlayer)
        else
            Rayfield:Notify({
                Title = "ì•Œë¦¼",
                Content = "ë¨¼ì € í”Œë ˆì´ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”!",
                Duration = 2
            })
        end
    end
end)

-- í”Œë ˆì´ì–´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
TeleportTab:CreateButton({
    Name = "ğŸ”„ í”Œë ˆì´ì–´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨",
    Callback = function()
        local newOptions = updatePlayerList()
        playerDropdown:Set(newOptions)
        
        -- ì„ íƒ ì´ˆê¸°í™” (ì„ íƒëœ í”Œë ˆì´ì–´ê°€ ëª©ë¡ì— ì—†ì„ ìˆ˜ ìˆìŒ)
        local stillExists = false
        if selectedPlayer then
            for _, plr in ipairs(Players:GetPlayers()) do
                if plr == selectedPlayer then
                    stillExists = true
                    break
                end
            end
        end
        
        if not stillExists then
            selectedPlayer = nil
        end
        
        Rayfield:Notify({
            Title = "ê°±ì‹  ì™„ë£Œ",
            Content = "í”Œë ˆì´ì–´ ëª©ë¡ì´ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ " .. #newOptions .. "ëª…ì˜ í”Œë ˆì´ì–´",
            Duration = 2
        })
    end,
})

-- í˜„ì¬ ì„ íƒëœ í”Œë ˆì´ì–´ ì •ë³´ í‘œì‹œ
local selectedInfoLabel = TeleportTab:CreateLabel("ì„ íƒëœ í”Œë ˆì´ì–´: ì—†ìŒ")

-- ì„ íƒ ì •ë³´ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
game:GetService("RunService").Heartbeat:Connect(function()
    if selectedPlayer then
        if selectedPlayer.Character and selectedPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local pos = selectedPlayer.Character.HumanoidRootPart.Position
            selectedInfoLabel:Set("ì„ íƒë¨: " .. selectedPlayer.Name .. " (ê±°ë¦¬: " .. 
                string.format("%.1f", (player.Character and player.Character:FindFirstChild("HumanoidRootPart") and 
                (player.Character.HumanoidRootPart.Position - pos).Magnitude or 0)) .. ")")
        else
            selectedInfoLabel:Set("ì„ íƒë¨: " .. selectedPlayer.Name .. " (ìºë¦­í„° ì—†ìŒ)")
        end
    else
        selectedInfoLabel:Set("ì„ íƒëœ í”Œë ˆì´ì–´: ì—†ìŒ")
    end
end)

--============================================================================--
-- 2.2 ì¼ë°˜ í…”ë ˆí¬íŠ¸ ê¸°ëŠ¥ (ê¸°ì¡´ ìœ ì§€)
--============================================================================--
local GeneralTPSection = TeleportTab:CreateSection("ì¼ë°˜ ìœ„ì¹˜ ì´ë™")

-- ìŠ¤í° ì§€ì—­ ì°¾ê¸° í•¨ìˆ˜
local function findSpawnLocation()
    local spawnCandidates = {
        workspace:FindFirstChild("SpawnLocation"),
        workspace:FindFirstChild("Spawn"),
        workspace:FindFirstChild("Start"),
        workspace:FindFirstChild("Baseplate")
    }
    
    for _, spawn in pairs(spawnCandidates) do
        if spawn and spawn:IsA("BasePart") then
            return spawn
        end
    end
    return nil
end

TeleportTab:CreateButton({
    Name = "ìŠ¤í° ì§€ì—­ìœ¼ë¡œ ì´ë™",
    Callback = function()
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local spawnLocation = findSpawnLocation()
            if spawnLocation then
                player.Character.HumanoidRootPart.CFrame = spawnLocation.CFrame + Vector3.new(0, 3, 0)
                Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "ìŠ¤í° ì§€ì—­ìœ¼ë¡œ ì´ë™ë¨", Duration = 2 })
            else
                player.Character.HumanoidRootPart.CFrame = CFrame.new(0, 10, 0)
                Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "ìŠ¤í° ì—†ìŒ, 0,0,0 ì¢Œí‘œë¡œ ì´ë™", Duration = 2 })
            end
        end
    end,
})

TeleportTab:CreateButton({
    Name = "í•˜ëŠ˜ë¡œ ì´ë™ (Y 500)",
    Callback = function()
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local currentPos = player.Character.HumanoidRootPart.Position
            player.Character.HumanoidRootPart.CFrame = CFrame.new(currentPos.X, 500, currentPos.Z)
            Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "í•˜ëŠ˜ë¡œ ì´ë™ë¨", Duration = 2 })
        end
    end,
})

TeleportTab:CreateButton({
    Name = "ë•…ìœ¼ë¡œ ì´ë™ (Y 0)",
    Callback = function()
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local currentPos = player.Character.HumanoidRootPart.Position
            player.Character.HumanoidRootPart.CFrame = CFrame.new(currentPos.X, 5, currentPos.Z)
            Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "ë•…ìœ¼ë¡œ ì´ë™ë¨", Duration = 2 })
        end
    end,
})

--============================================================================--
-- 3. ê·¸ ì™¸ íƒ­
--============================================================================--
local MiscTab = Window:CreateTab("ê·¸ ì™¸", 4483362458)
local MiscSection = MiscTab:CreateSection("ê¸°íƒ€ ì„¤ì •")

MiscTab:CreateButton({
    Name = "UI ì™„ì „ ì¢…ë£Œ",
    Callback = function()
        Rayfield:Destroy()
    end,
})

MiscTab:CreateButton({
    Name = "ìºë¦­í„° ë¦¬ì…‹ (ì£½ì´ê¸°)",
    Callback = function()
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.Health = 0
            Rayfield:Notify({ Title = "ê·¸ ì™¸", Content = "ìºë¦­í„° ë¦¬ì…‹ë¨", Duration = 2 })
        end
    end,
})

MiscTab:CreateButton({
    Name = "FPS ë¶€ìŠ¤íŠ¸",
    Callback = function()
        settings().Rendering.QualityLevel = 1
        game:GetService("RunService"):Set3dRenderingEnabled(false)
        wait(0.1)
        game:GetService("RunService"):Set3dRenderingEnabled(true)
        
        Rayfield:Notify({ Title = "ê·¸ ì™¸", Content = "FPS ë¶€ìŠ¤íŠ¸ ì ìš©ë¨", Duration = 2 })
    end,
})
