--[[
    ìœ ë‹ˆë²„ìŠ¤ (Universe) - ì„¬ì„¸í•œ ìµœì¢… ë²„ì „
    ëª¨ë“  ê¸°ëŠ¥ì´ ì™„ë²½í•˜ê²Œ ì‘ë™í•˜ëŠ” ìµœì í™”ëœ ìŠ¤í¬ë¦½íŠ¸
]]

-- ì„œë¹„ìŠ¤ ë¡œë“œ
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Players = game:GetService("Players")
local UserInput = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")
local TweenService = game:GetService("TweenService")
local Debris = game:GetService("Debris")

-- ë¡œì»¬ í”Œë ˆì´ì–´
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

--============================================================================--
-- ìœˆë„ìš° ìƒì„±
--============================================================================--
local Window = Rayfield:CreateWindow({
    Name = "ìœ ë‹ˆë²„ìŠ¤ (Universe)",
    LoadingTitle = "ìœ ë‹ˆë²„ìŠ¤ ë¡œë”© ì¤‘...",
    LoadingSubtitle = "v2.0 - ì–¼í‹°ë©”ì´íŠ¸ ì—ë””ì…˜",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "UniverseHub",
        FileName = "Config"
    },
    ToggleUIKeybind = "K",
    KeySystem = false,
})

--============================================================================--
-- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
--============================================================================--
local function WaitForCharacter()
    repeat 
        task.wait()
    until LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    return LocalPlayer.Character
end

local function SafeCall(func, ...)
    local success, result = pcall(func, ...)
    return result
end

local function CreateEffect(position, color, size)
    local effect = Instance.new("Part")
    effect.Size = size or Vector3.new(3, 3, 3)
    effect.Position = position
    effect.BrickColor = BrickColor.new(color or "Bright blue")
    effect.Material = Enum.Material.Neon
    effect.Transparency = 0.3
    effect.Anchored = true
    effect.CanCollide = false
    effect.Parent = workspace
    Debris:AddItem(effect, 1)
    
    -- ì„œì„œíˆ ì‚¬ë¼ì§€ëŠ” íš¨ê³¼
    task.spawn(function()
        for i = 1, 10 do
            effect.Transparency = effect.Transparency + 0.07
            effect.Size = effect.Size + Vector3.new(0.3, 0.3, 0.3)
            task.wait(0.03)
        end
        effect:Destroy()
    end)
end

--============================================================================--
-- ë©”ì¸ íƒ­
--============================================================================--
local MainTab = Window:CreateTab("ë©”ì¸", 4483362458)
local MainSection = MainTab:CreateSection("ì´ë™ ë° ë¬¼ë¦¬")

-- í™˜ì˜ ë©”ì‹œì§€
Rayfield:Notify({
    Title = "âœ¨ ìœ ë‹ˆë²„ìŠ¤ ì‹¤í–‰ë¨",
    Content = "Kí‚¤ë¥¼ ëˆŒëŸ¬ UIë¥¼ í† ê¸€í•˜ì„¸ìš”",
    Duration = 3,
})

------------------------------------------------------------------------
-- ì†ë„ ì¡°ì ˆ
------------------------------------------------------------------------
local WalkSpeed = 16
local SpeedConnection = nil

local SpeedSlider = MainTab:CreateSlider({
    Name = "âš¡ ì†ë„ ì¡°ì ˆ (1~5000)",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "WalkSpeed",
    CurrentValue = 16,
    Flag = "SpeedSlider",
    Callback = function(value)
        WalkSpeed = value
        if LocalPlayer.Character then
            local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = value
            end
        end
    end,
})

local SpeedLabel = MainTab:CreateLabel("í˜„ì¬ ì†ë„: 16")

RunService.Heartbeat:Connect(function()
    if LocalPlayer.Character then
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            local current = humanoid.WalkSpeed
            SpeedLabel:Set("í˜„ì¬ ì†ë„: " .. math.floor(current))
            
            -- ì†ë„ ê°•ì œ ìœ ì§€
            if current ~= WalkSpeed and WalkSpeed > 0 then
                humanoid.WalkSpeed = WalkSpeed
            end
        end
    end
end)

------------------------------------------------------------------------
-- ì í”„ë ¥ ì¡°ì ˆ
------------------------------------------------------------------------
local JumpPower = 50
local JumpLabel = MainTab:CreateLabel("í˜„ì¬ ì í”„ë ¥: 50")

MainTab:CreateSlider({
    Name = "ğŸ¦˜ ì í”„ë ¥ ì¡°ì ˆ (1~5000)",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "JumpPower",
    CurrentValue = 50,
    Flag = "JumpSlider",
    Callback = function(value)
        JumpPower = value
        if LocalPlayer.Character then
            local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = value
            end
        end
    end,
})

RunService.Heartbeat:Connect(function()
    if LocalPlayer.Character then
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            JumpLabel:Set("í˜„ì¬ ì í”„ë ¥: " .. math.floor(humanoid.JumpPower))
        end
    end
end)

------------------------------------------------------------------------
-- ì¤‘ë ¥ ì¡°ì ˆ
------------------------------------------------------------------------
local GravityLabel = MainTab:CreateLabel("í˜„ì¬ ì¤‘ë ¥: 196.2")

MainTab:CreateSlider({
    Name = "ğŸŒ ì¤‘ë ¥ ì¡°ì ˆ (1~5000)",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "Gravity",
    CurrentValue = 196.2,
    Flag = "GravitySlider",
    Callback = function(value)
        workspace.Gravity = value
    end,
})

RunService.Heartbeat:Connect(function()
    GravityLabel:Set("í˜„ì¬ ì¤‘ë ¥: " .. math.floor(workspace.Gravity))
end)

------------------------------------------------------------------------
-- í”Œë¼ì´ ê¸°ëŠ¥
------------------------------------------------------------------------
MainTab:CreateSection("ğŸ¦… í”Œë¼ì´ ëª¨ë“œ")

local FlyEnabled = false
local FlySpeed = 50
local FlyConnection = nil
local BodyVelocity = nil
local BodyGyro = nil

MainTab:CreateSlider({
    Name = "í”Œë¼ì´ ì†ë„ (1~5000)",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "FlySpeed",
    CurrentValue = 50,
    Flag = "FlySpeedSlider",
    Callback = function(value)
        FlySpeed = value
        if BodyVelocity then
            BodyVelocity.MaxForce = Vector3.new(value * 1000, value * 1000, value * 1000)
        end
    end,
})

MainTab:CreateToggle({
    Name = "í”Œë¼ì´ ON/OFF",
    CurrentValue = false,
    Flag = "FlyToggle",
    Callback = function(state)
        FlyEnabled = state
        
        if FlyEnabled then
            -- í”Œë¼ì´ í™œì„±í™”
            local character = LocalPlayer.Character or WaitForCharacter()
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            
            if not (rootPart and humanoid) then
                Rayfield:Notify({ Title = "ì˜¤ë¥˜", Content = "ìºë¦­í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ", Duration = 2 })
                return
            end
            
            -- ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬
            if BodyVelocity then BodyVelocity:Destroy() end
            if BodyGyro then BodyGyro:Destroy() end
            
            -- BodyVelocity ìƒì„±
            BodyVelocity = Instance.new("BodyVelocity")
            BodyVelocity.Velocity = Vector3.new()
            BodyVelocity.MaxForce = Vector3.new(FlySpeed * 1000, FlySpeed * 1000, FlySpeed * 1000)
            BodyVelocity.P = 10000
            BodyVelocity.Parent = rootPart
            
            -- BodyGyro ìƒì„±
            BodyGyro = Instance.new("BodyGyro")
            BodyGyro.MaxTorque = Vector3.new(40000, 40000, 40000)
            BodyGyro.P = 10000
            BodyGyro.CFrame = rootPart.CFrame
            BodyGyro.Parent = rootPart
            
            humanoid.PlatformStand = true
            
            -- í”Œë¼ì´ ì—…ë°ì´íŠ¸ ë£¨í”„
            FlyConnection = RunService.Heartbeat:Connect(function()
                if not (FlyEnabled and LocalPlayer.Character and rootPart and BodyVelocity) then
                    return
                end
                
                local moveDir = Vector3.new()
                local camera = workspace.CurrentCamera
                
                if UserInput:IsKeyDown(Enum.KeyCode.W) then
                    moveDir = moveDir + camera.CFrame.LookVector
                end
                if UserInput:IsKeyDown(Enum.KeyCode.S) then
                    moveDir = moveDir - camera.CFrame.LookVector
                end
                if UserInput:IsKeyDown(Enum.KeyCode.A) then
                    moveDir = moveDir - camera.CFrame.RightVector
                end
                if UserInput:IsKeyDown(Enum.KeyCode.D) then
                    moveDir = moveDir + camera.CFrame.RightVector
                end
                if UserInput:IsKeyDown(Enum.KeyCode.Space) then
                    moveDir = moveDir + Vector3.new(0, 1, 0)
                end
                if UserInput:IsKeyDown(Enum.KeyCode.LeftControl) then
                    moveDir = moveDir + Vector3.new(0, -1, 0)
                end
                
                -- ì´ë™ ë²¡í„° ì •ê·œí™”
                if moveDir.Magnitude > 0 then
                    moveDir = moveDir.Unit * FlySpeed
                end
                
                BodyVelocity.Velocity = moveDir
                BodyGyro.CFrame = camera.CFrame
            end)
            
            Rayfield:Notify({
                Title = "í”Œë¼ì´",
                Content = "WASD: ì´ë™ | ìŠ¤í˜ì´ìŠ¤: ìƒìŠ¹ | Ctrl: í•˜ê°•",
                Duration = 3
            })
            
        else
            -- í”Œë¼ì´ ë¹„í™œì„±í™”
            if FlyConnection then
                FlyConnection:Disconnect()
                FlyConnection = nil
            end
            
            if BodyVelocity then
                BodyVelocity:Destroy()
                BodyVelocity = nil
            end
            
            if BodyGyro then
                BodyGyro:Destroy()
                BodyGyro = nil
            end
            
            if LocalPlayer.Character then
                local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.PlatformStand = false
                end
            end
            
            Rayfield:Notify({ Title = "í”Œë¼ì´", Content = "ë¹„í™œì„±í™”ë¨", Duration = 2 })
        end
    end,
})

local FlyStatusLabel = MainTab:CreateLabel("í”Œë¼ì´ ìƒíƒœ: êº¼ì§")

RunService.Heartbeat:Connect(function()
    FlyStatusLabel:Set("í”Œë¼ì´ ìƒíƒœ: " .. (FlyEnabled and ("ì¼œì§ (ì†ë„: " .. FlySpeed .. ")") or "êº¼ì§"))
end)

------------------------------------------------------------------------
-- í”„ë¦¬ì¦ˆ ê¸°ëŠ¥
------------------------------------------------------------------------
MainTab:CreateSection("â„ï¸ í”„ë¦¬ì¦ˆ ëª¨ë“œ")

local FreezeEnabled = false
local FreezePosition = nil
local FreezeConnection = nil

MainTab:CreateToggle({
    Name = "í”„ë¦¬ì¦ˆ (ìœ„ì¹˜ ê³ ì •)",
    CurrentValue = false,
    Flag = "FreezeToggle",
    Callback = function(state)
        FreezeEnabled = state
        
        if FreezeEnabled then
            -- í˜„ì¬ ìœ„ì¹˜ ì €ì¥
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                FreezePosition = LocalPlayer.Character.HumanoidRootPart.CFrame
                
                -- ìœ„ì¹˜ ê³ ì • ë£¨í”„
                FreezeConnection = RunService.Heartbeat:Connect(function()
                    if FreezeEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                        LocalPlayer.Character.HumanoidRootPart.CFrame = FreezePosition
                        
                        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                        if humanoid then
                            humanoid.PlatformStand = true
                        end
                    end
                end)
                
                Rayfield:Notify({ Title = "í”„ë¦¬ì¦ˆ", Content = "ìœ„ì¹˜ ê³ ì • ON", Duration = 2 })
            else
                Rayfield:Notify({ Title = "ì˜¤ë¥˜", Content = "ìºë¦­í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ", Duration = 2 })
                FreezeEnabled = false
            end
        else
            -- í”„ë¦¬ì¦ˆ í•´ì œ
            if FreezeConnection then
                FreezeConnection:Disconnect()
                FreezeConnection = nil
            end
            
            if LocalPlayer.Character then
                local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.PlatformStand = false
                end
            end
            
            Rayfield:Notify({ Title = "í”„ë¦¬ì¦ˆ", Content = "í•´ì œë¨", Duration = 2 })
        end
    end,
})

------------------------------------------------------------------------
-- ë¬´í•œ ì í”„
------------------------------------------------------------------------
local InfiniteJumpEnabled = false
local JumpConnection = nil

MainTab:CreateToggle({
    Name = "âˆ ë¬´í•œ ì í”„",
    CurrentValue = false,
    Flag = "InfiniteJump",
    Callback = function(state)
        InfiniteJumpEnabled = state
        
        if InfiniteJumpEnabled then
            JumpConnection = UserInput.JumpRequest:Connect(function()
                if LocalPlayer.Character then
                    local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                    if humanoid then
                        humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                    end
                end
            end)
            Rayfield:Notify({ Title = "ë¬´í•œ ì í”„", Content = "í™œì„±í™”ë¨", Duration = 2 })
        else
            if JumpConnection then
                JumpConnection:Disconnect()
                JumpConnection = nil
            end
            Rayfield:Notify({ Title = "ë¬´í•œ ì í”„", Content = "ë¹„í™œì„±í™”ë¨", Duration = 2 })
        end
    end,
})

------------------------------------------------------------------------
-- ë²½ëš«ê¸°
------------------------------------------------------------------------
local NoclipEnabled = false
local NoclipConnection = nil

MainTab:CreateToggle({
    Name = "ğŸ§± ë²½ëš«ê¸° (Noclip)",
    CurrentValue = false,
    Flag = "Noclip",
    Callback = function(state)
        NoclipEnabled = state
        
        if NoclipEnabled then
            NoclipConnection = RunService.Stepped:Connect(function()
                if LocalPlayer.Character then
                    for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = false
                        end
                    end
                end
            end)
            Rayfield:Notify({ Title = "ë²½ëš«ê¸°", Content = "í™œì„±í™”ë¨", Duration = 2 })
        else
            if NoclipConnection then
                NoclipConnection:Disconnect()
                NoclipConnection = nil
            end
            Rayfield:Notify({ Title = "ë²½ëš«ê¸°", Content = "ë¹„í™œì„±í™”ë¨", Duration = 2 })
        end
    end,
})

------------------------------------------------------------------------
-- PCLD (í”Œë ˆì´ì–´ ID í‘œì‹œ)
------------------------------------------------------------------------
MainTab:CreateSection("ğŸ‘¤ PCLD - í”Œë ˆì´ì–´ ID")

local PCLDEnabled = false
local PCLDMarkers = {}
local PCLDConnection = nil

local function CreateIDMarker(targetPlayer)
    if not (targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart")) then
        return nil
    end
    
    local marker = Instance.new("Part")
    marker.Size = Vector3.new(1, 1, 1)
    marker.Transparency = 1
    marker.Anchored = true
    marker.CanCollide = false
    marker.Parent = workspace
    
    local billboard = Instance.new("BillboardGui")
    billboard.Size = UDim2.new(0, 160, 0, 60)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = marker
    
    local background = Instance.new("Frame")
    background.Size = UDim2.new(1, 0, 1, 0)
    background.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    background.BackgroundTransparency = 0.2
    background.BorderSizePixel = 2
    background.BorderColor3 = Color3.fromRGB(255, 100, 100)
    background.Parent = billboard
    
    local idLabel = Instance.new("TextLabel")
    idLabel.Size = UDim2.new(1, 0, 0.5, 0)
    idLabel.Position = UDim2.new(0, 0, 0, 0)
    idLabel.BackgroundTransparency = 1
    idLabel.Text = "ğŸ†” " .. targetPlayer.UserId
    idLabel.TextColor3 = Color3.fromRGB(255, 200, 200)
    idLabel.TextStrokeTransparency = 0.3
    idLabel.TextStrokeColor3 = Color3.fromRGB(255, 0, 0)
    idLabel.Font = Enum.Font.GothamBold
    idLabel.TextSize = 16
    idLabel.Parent = background
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    nameLabel.Position = UDim2.new(0, 0, 0.5, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = "ğŸ“Œ " .. targetPlayer.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextStrokeTransparency = 0
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.Font = Enum.Font.Gotham
    nameLabel.TextSize = 12
    nameLabel.Parent = background
    
    return marker
end

MainTab:CreateToggle({
    Name = "PCLD ON/OFF",
    CurrentValue = false,
    Flag = "PCLD",
    Callback = function(state)
        PCLDEnabled = state
        
        if PCLDEnabled then
            -- ê¸°ì¡´ ë§ˆì»¤ ì œê±°
            for _, marker in pairs(PCLDMarkers) do
                SafeCall(marker.Destroy, marker)
            end
            PCLDMarkers = {}
            
            -- ìƒˆ ë§ˆì»¤ ìƒì„±
            for _, player in ipairs(Players:GetPlayers()) do
                if player ~= LocalPlayer then
                    local marker = CreateIDMarker(player)
                    if marker then
                        PCLDMarkers[player] = marker
                    end
                end
            end
            
            -- ì—…ë°ì´íŠ¸ ë£¨í”„
            PCLDConnection = RunService.Heartbeat:Connect(function()
                if not PCLDEnabled then return end
                
                -- ê¸°ì¡´ ë§ˆì»¤ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                for player, marker in pairs(PCLDMarkers) do
                    SafeCall(function()
                        if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                            marker.CFrame = player.Character.HumanoidRootPart.CFrame
                        else
                            marker:Destroy()
                            PCLDMarkers[player] = nil
                        end
                    end)
                end
                
                -- ìƒˆ í”Œë ˆì´ì–´ ë§ˆì»¤ ìƒì„±
                for _, player in ipairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer and not PCLDMarkers[player] then
                        local marker = CreateIDMarker(player)
                        if marker then
                            PCLDMarkers[player] = marker
                        end
                    end
                end
            end)
            
            Rayfield:Notify({ Title = "PCLD", Content = "í”Œë ˆì´ì–´ ID í‘œì‹œ ON", Duration = 2 })
        else
            if PCLDConnection then
                PCLDConnection:Disconnect()
                PCLDConnection = nil
            end
            
            for _, marker in pairs(PCLDMarkers) do
                SafeCall(marker.Destroy, marker)
            end
            PCLDMarkers = {}
            
            Rayfield:Notify({ Title = "PCLD", Content = "OFF", Duration = 2 })
        end
    end,
})

--============================================================================--
-- í…”ë ˆí¬íŠ¸ íƒ­
--============================================================================--
local TeleportTab = Window:CreateTab("í…”ë ˆí¬íŠ¸", 4483362458)
local TeleportSection = TeleportTab:CreateSection("í”Œë ˆì´ì–´ í…”ë ˆí¬íŠ¸ (0.3ì´ˆ)")

local SelectedPlayer = nil
local IsTeleporting = false

-- í”Œë ˆì´ì–´ ëª©ë¡ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
local function GetPlayerList()
    local list = {}
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            table.insert(list, player.Name)
        end
    end
    return list
end

-- í”Œë ˆì´ì–´ ì„ íƒ ë“œë¡­ë‹¤ìš´
local PlayerDropdown = TeleportTab:CreateDropdown({
    Name = "ğŸ¯ í”Œë ˆì´ì–´ ì„ íƒ",
    Options = GetPlayerList(),
    CurrentOption = {"ì„ íƒí•˜ì„¸ìš”"},
    MultipleOptions = false,
    Flag = "PlayerSelect",
    Callback = function(selected)
        if selected and #selected > 0 then
            local selectedName = selected[1]
            for _, player in ipairs(Players:GetPlayers()) do
                if player.Name == selectedName then
                    SelectedPlayer = player
                    Rayfield:Notify({
                        Title = "ì„ íƒë¨",
                        Content = player.Name .. " (ID: " .. player.UserId .. ")",
                        Duration = 2
                    })
                    break
                end
            end
        end
    end,
})

-- ìƒíƒœ í‘œì‹œ ë ˆì´ë¸”
local StatusLabel = TeleportTab:CreateLabel("â³ ìƒíƒœ: ëŒ€ê¸° ì¤‘")

-- í…”ë ˆí¬íŠ¸ í•¨ìˆ˜
local function TeleportToPlayer(target)
    if IsTeleporting then
        Rayfield:Notify({ Title = "ê²½ê³ ", Content = "ì´ë¯¸ í…”ë ˆí¬íŠ¸ ì¤‘ì…ë‹ˆë‹¤", Duration = 2 })
        return
    end
    
    if not target then
        Rayfield:Notify({ Title = "ì˜¤ë¥˜", Content = "í”Œë ˆì´ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”", Duration = 2 })
        return
    end
    
    -- ëŒ€ìƒ í™•ì¸
    local targetExists = false
    for _, p in ipairs(Players:GetPlayers()) do
        if p == target then
            targetExists = true
            break
        end
    end
    
    if not targetExists then
        Rayfield:Notify({ Title = "ì˜¤ë¥˜", Content = "ëŒ€ìƒì´ ê²Œì„ì— ì—†ìŠµë‹ˆë‹¤", Duration = 2 })
        SelectedPlayer = nil
        return
    end
    
    if not (target.Character and target.Character:FindFirstChild("HumanoidRootPart")) then
        Rayfield:Notify({ Title = "ì˜¤ë¥˜", Content = "ëŒ€ìƒì˜ ìºë¦­í„°ê°€ ì—†ìŠµë‹ˆë‹¤", Duration = 2 })
        return
    end
    
    if not (LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")) then
        Rayfield:Notify({ Title = "ì˜¤ë¥˜", Content = "ë‚´ ìºë¦­í„°ê°€ ì—†ìŠµë‹ˆë‹¤", Duration = 2 })
        return
    end
    
    IsTeleporting = true
    StatusLabel:Set("â³ ìƒíƒœ: í…”ë ˆí¬íŠ¸ ì¤€ë¹„ ì¤‘...")
    
    -- 0.3ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´ (3íšŒ)
    for i = 1, 3 do
        local remaining = (4 - i) / 10
        StatusLabel:Set("â³ ìƒíƒœ: " .. string.format("%.1f", remaining) .. "ì´ˆ í›„ ì´ë™")
        
        -- í™”ë©´ í”ë“¤ë¦¼
        SafeCall(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local root = LocalPlayer.Character.HumanoidRootPart
                root.CFrame = root.CFrame + Vector3.new(
                    math.random(-15, 15) / 10,
                    math.random(-15, 15) / 10,
                    math.random(-15, 15) / 10
                )
            end
        end)
        
        task.wait(0.1)
    end
    
    -- í…”ë ˆí¬íŠ¸ ì‹¤í–‰
    SafeCall(function()
        local targetCF = target.Character.HumanoidRootPart.CFrame
        LocalPlayer.Character.HumanoidRootPart.CFrame = targetCF + Vector3.new(0, 5, 0)
        CreateEffect(LocalPlayer.Character.HumanoidRootPart.Position, "Bright blue", Vector3.new(3, 3, 3))
    end)
    
    Rayfield:Notify({
        Title = "âœ… í…”ë ˆí¬íŠ¸ ì™„ë£Œ",
        Content = target.Name .. "ë‹˜ì—ê²Œ ì´ë™í–ˆìŠµë‹ˆë‹¤",
        Duration = 3
    })
    
    StatusLabel:Set("â³ ìƒíƒœ: ëŒ€ê¸° ì¤‘")
    IsTeleporting = false
end

-- í…”ë ˆí¬íŠ¸ ë²„íŠ¼
TeleportTab:CreateButton({
    Name = "ğŸš€ ì„ íƒí•œ í”Œë ˆì´ì–´ì—ê²Œ í…”ë ˆí¬íŠ¸",
    Callback = function()
        TeleportToPlayer(SelectedPlayer)
    end,
})

-- T í‚¤ ë‹¨ì¶•í‚¤
UserInput.InputBegan:Connect(function(input, isTyping)
    if not isTyping and input.KeyCode == Enum.KeyCode.T then
        if SelectedPlayer then
            TeleportToPlayer(SelectedPlayer)
        else
            Rayfield:Notify({ Title = "ì•Œë¦¼", Content = "ë¨¼ì € í”Œë ˆì´ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”", Duration = 2 })
        end
    end
end)

-- ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
TeleportTab:CreateButton({
    Name = "ğŸ”„ í”Œë ˆì´ì–´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨",
    Callback = function()
        local newList = GetPlayerList()
        PlayerDropdown:Set(newList)
        
        -- ì„ íƒëœ í”Œë ˆì´ì–´ í™•ì¸
        if SelectedPlayer then
            local stillExists = false
            for _, p in ipairs(Players:GetPlayers()) do
                if p == SelectedPlayer then
                    stillExists = true
                    break
                end
            end
            if not stillExists then
                SelectedPlayer = nil
            end
        end
        
        Rayfield:Notify({
            Title = "ê°±ì‹  ì™„ë£Œ",
            Content = "í”Œë ˆì´ì–´ " .. #newList .. "ëª…",
            Duration = 2
        })
    end,
})

-- ì„ íƒ ì •ë³´ í‘œì‹œ
local SelectedInfoLabel = TeleportTab:CreateLabel("ì„ íƒëœ í”Œë ˆì´ì–´: ì—†ìŒ")

RunService.Heartbeat:Connect(function()
    if SelectedPlayer then
        SafeCall(function()
            local info = "ì„ íƒë¨: " .. SelectedPlayer.Name
            
            if SelectedPlayer.Character and SelectedPlayer.Character:FindFirstChild("HumanoidRootPart") and
               LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local dist = (LocalPlayer.Character.HumanoidRootPart.Position - 
                             SelectedPlayer.Character.HumanoidRootPart.Position).Magnitude
                info = info .. string.format(" (%.1f studs)", dist)
            end
            
            SelectedInfoLabel:Set(info)
        end)
    else
        SelectedInfoLabel:Set("ì„ íƒëœ í”Œë ˆì´ì–´: ì—†ìŒ")
    end
end)

-- ì¼ë°˜ í…”ë ˆí¬íŠ¸
local GeneralSection = TeleportTab:CreateSection("ì¼ë°˜ ìœ„ì¹˜ ì´ë™")

local function FindSpawn()
    local spawns = {
        workspace:FindFirstChild("SpawnLocation"),
        workspace:FindFirstChild("Spawn"),
        workspace:FindFirstChild("Start"),
        workspace:FindFirstChild("Baseplate")
    }
    for _, spawn in pairs(spawns) do
        if spawn and spawn:IsA("BasePart") then
            return spawn
        end
    end
    return nil
end

TeleportTab:CreateButton({
    Name = "ğŸ  ìŠ¤í° ì§€ì—­ìœ¼ë¡œ ì´ë™",
    Callback = function()
        SafeCall(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local spawn = FindSpawn()
                if spawn then
                    LocalPlayer.Character.HumanoidRootPart.CFrame = spawn.CFrame + Vector3.new(0, 3, 0)
                    Rayfield:Notify({ Title = "ì´ë™", Content = "ìŠ¤í° ì§€ì—­", Duration = 2 })
                else
                    LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(0, 10, 0)
                    Rayfield:Notify({ Title = "ì´ë™", Content = "0,0,0 ì¢Œí‘œ", Duration = 2 })
                end
            end
        end)
    end,
})

TeleportTab:CreateButton({
    Name = "â˜ï¸ í•˜ëŠ˜ë¡œ ì´ë™ (Y=500)",
    Callback = function()
        SafeCall(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local pos = LocalPlayer.Character.HumanoidRootPart.Position
                LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(pos.X, 500, pos.Z)
                Rayfield:Notify({ Title = "ì´ë™", Content = "í•˜ëŠ˜ (Y=500)", Duration = 2 })
            end
        end)
    end,
})

TeleportTab:CreateButton({
    Name = "ğŸŒ ë•…ìœ¼ë¡œ ì´ë™ (Y=5)",
    Callback = function()
        SafeCall(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local pos = LocalPlayer.Character.HumanoidRootPart.Position
                LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(pos.X, 5, pos.Z)
                Rayfield:Notify({ Title = "ì´ë™", Content = "ë•… (Y=5)", Duration = 2 })
            end
        end)
    end,
})

--============================================================================--
-- ê·¸ ì™¸ íƒ­
--============================================================================--
local MiscTab = Window:CreateTab("ê·¸ ì™¸", 4483362458)

-- ì¬ì ‘ì†
local RejoinSection = MiscTab:CreateSection("ê²Œì„ ê´€ë¦¬")

MiscTab:CreateButton({
    Name = "ğŸ”„ ì¬ì ‘ì† (ê²Œì„ ë‚˜ê°”ë‹¤ ë“¤ì–´ì˜¤ê¸°)",
    Callback = function()
        Rayfield:Notify({
            Title = "ì¬ì ‘ì†",
            Content = "3ì´ˆ í›„ ì¬ì ‘ì†í•©ë‹ˆë‹¤...",
            Duration = 3
        })
        task.wait(3)
        TeleportService:Teleport(game.PlaceId, LocalPlayer)
    end,
})

-- ì—ì„ í…”ë ˆí¬íŠ¸
local AimTPSection = MiscTab:CreateSection("ì—ì„ í…”ë ˆí¬íŠ¸")

local AimTPEnabled = false
local AimTPKey = Enum.KeyCode.X
local AimTPConnection = nil

-- í‚¤ ë³€ê²½ ë ˆì´ë¸”
local AimTPKeyLabel = MiscTab:CreateLabel("í˜„ì¬ í‚¤: X")

-- í‚¤ë°”ì¸ë“œ
MiscTab:CreateKeybind({
    Name = "ì—ì„ TP í‚¤ ë³€ê²½",
    CurrentKeybind = "X",
    Flag = "AimTPKeybind",
    Callback = function(key)
        if key then
            local keyMap = {
                ["Q"] = Enum.KeyCode.Q, ["W"] = Enum.KeyCode.W, ["E"] = Enum.KeyCode.E,
                ["R"] = Enum.KeyCode.R, ["T"] = Enum.KeyCode.T, ["Y"] = Enum.KeyCode.Y,
                ["U"] = Enum.KeyCode.U, ["I"] = Enum.KeyCode.I, ["O"] = Enum.KeyCode.O,
                ["P"] = Enum.KeyCode.P, ["A"] = Enum.KeyCode.A, ["S"] = Enum.KeyCode.S,
                ["D"] = Enum.KeyCode.D, ["F"] = Enum.KeyCode.F, ["G"] = Enum.KeyCode.G,
                ["H"] = Enum.KeyCode.H, ["J"] = Enum.KeyCode.J, ["K"] = Enum.KeyCode.K,
                ["L"] = Enum.KeyCode.L, ["Z"] = Enum.KeyCode.Z, ["X"] = Enum.KeyCode.X,
                ["C"] = Enum.KeyCode.C, ["V"] = Enum.KeyCode.V, ["B"] = Enum.KeyCode.B,
                ["N"] = Enum.KeyCode.N, ["M"] = Enum.KeyCode.M
            }
            AimTPKey = keyMap[key] or Enum.KeyCode.X
            AimTPKeyLabel:Set("í˜„ì¬ í‚¤: " .. key)
            Rayfield:Notify({ Title = "í‚¤ ë³€ê²½", Content = "ì—ì„ TP: " .. key, Duration = 2 })
        end
    end,
})

-- ì—ì„ TP í† ê¸€
MiscTab:CreateToggle({
    Name = "ì—ì„ í…”ë ˆí¬íŠ¸ ON/OFF",
    CurrentValue = false,
    Flag = "AimTP",
    Callback = function(state)
        AimTPEnabled = state
        
        if AimTPEnabled then
            if AimTPConnection then
                AimTPConnection:Disconnect()
            end
            
            AimTPConnection = UserInput.InputBegan:Connect(function(input, isTyping)
                if not isTyping and input.KeyCode == AimTPKey then
                    SafeCall(function()
                        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                            local mousePos = Mouse.Hit.Position
                            LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(
                                mousePos.X,
                                mousePos.Y + 3,
                                mousePos.Z
                            )
                            
                            CreateEffect(mousePos, "Bright red", Vector3.new(2, 2, 2))
                            
                            Rayfield:Notify({
                                Title = "ì—ì„ TP",
                                Content = "ë§ˆìš°ìŠ¤ ìœ„ì¹˜ë¡œ ì´ë™",
                                Duration = 1
                            })
                        end
                    end)
                end
            end)
            
            Rayfield:Notify({
                Title = "ì—ì„ TP",
                Content = "í™œì„±í™”ë¨ (" .. AimTPKey.Name .. "í‚¤)",
                Duration = 2
            })
        else
            if AimTPConnection then
                AimTPConnection:Disconnect()
                AimTPConnection = nil
            end
            Rayfield:Notify({ Title = "ì—ì„ TP", Content = "ë¹„í™œì„±í™”ë¨", Duration = 2 })
        end
    end,
})

-- ê¸°íƒ€ ê¸°ëŠ¥ë“¤
local MiscSection = MiscTab:CreateSection("ê¸°íƒ€ ê¸°ëŠ¥")

MiscTab:CreateButton({
    Name = "âŒ UI ì™„ì „ ì¢…ë£Œ",
    Callback = function()
        Rayfield:Destroy()
    end,
})

MiscTab:CreateButton({
    Name = "ğŸ’€ ìºë¦­í„° ë¦¬ì…‹ (ì£½ì´ê¸°)",
    Callback = function()
        SafeCall(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                LocalPlayer.Character.Humanoid.Health = 0
                Rayfield:Notify({ Title = "ë¦¬ì…‹", Content = "ìºë¦­í„° ì‚¬ë§", Duration = 2 })
            end
        end)
    end,
})

MiscTab:CreateButton({
    Name = "âš¡ FPS ë¶€ìŠ¤íŠ¸",
    Callback = function()
        SafeCall(function()
            settings().Rendering.QualityLevel = 1
            RunService:Set3dRenderingEnabled(false)
            task.wait(0.1)
            RunService:Set3dRenderingEnabled(true)
            Rayfield:Notify({ Title = "FPS", Content = "ë¶€ìŠ¤íŠ¸ ì ìš©ë¨", Duration = 2 })
        end)
    end,
})

-- ìºë¦­í„° ë¦¬ìŠ¤í° ì²˜ë¦¬
LocalPlayer.CharacterAdded:Connect(function(character)
    -- ì†ë„ ì ìš©
    task.wait(0.5)
    SafeCall(function()
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = WalkSpeed
            humanoid.JumpPower = JumpPower
        end
    end)
    
    -- í”„ë¦¬ì¦ˆ ìƒíƒœ ì²˜ë¦¬
    if FreezeEnabled then
        Rayfield:Notify({
            Title = "í”„ë¦¬ì¦ˆ",
            Content = "ìºë¦­í„°ê°€ ë¦¬ìŠ¤í°ë¨. í”„ë¦¬ì¦ˆë¥¼ ë‹¤ì‹œ ì¼œì£¼ì„¸ìš”.",
            Duration = 3
        })
    end
    
    -- í”Œë¼ì´ ìƒíƒœ ì²˜ë¦¬
    if FlyEnabled then
        Rayfield:Notify({
            Title = "í”Œë¼ì´",
            Content = "ìºë¦­í„°ê°€ ë¦¬ìŠ¤í°ë¨. í”Œë¼ì´ë¥¼ ë‹¤ì‹œ ì¼œì£¼ì„¸ìš”.",
            Duration = 3
        })
    end
end)

-- ì‹œì‘ ì™„ë£Œ ì•Œë¦¼
Rayfield:Notify({
    Title = "âœ¨ ìœ ë‹ˆë²„ìŠ¤ ë¡œë“œ ì™„ë£Œ",
    Content = "ëª¨ë“  ê¸°ëŠ¥ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤",
    Duration = 3
})
