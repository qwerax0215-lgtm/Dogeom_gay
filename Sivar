-- Rayfield 라이브러리 로드
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Window 생성 (핵 이름: 동혁이 쓰려고 만든 핵) - 키 시스템 완전 제거
local Window = Rayfield:CreateWindow({
    Name = "동혁이 쓰려고 만든 핵",
    LoadingTitle = "동혁이 쓰려고 만든 핵",
    LoadingSubtitle = "by Rayfield",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "DongHyukHack",
        FileName = "Config"
    },
    Discord = {
        Enabled = false,
        Invite = "",
        RememberJoins = true
    },
    KeySystem = false  -- 키 시스템 비활성화
    -- KeySettings 부분 완전히 제거함
})

-- 메인 탭 생성
local MainTab = Window:CreateTab("메인", "home")

-- 속도핵 관련 변수
local speedEnabled = false
local speedValue = 50
local originalWalkSpeed = 16
local speedConnection = nil

-- 속도핵 설정 함수
local function setupSpeed()
    local player = game.Players.LocalPlayer
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end
    
    if speedEnabled then
        -- 속도핵 켜기: 설정된 속도 적용
        humanoid.WalkSpeed = speedValue
        
        -- 기존 연결 제거
        if speedConnection then
            speedConnection:Disconnect()
        end
        
        -- 속도 유지 (게임이 속도를 변경할 수 있으므로 지속적으로 감시)
        speedConnection = game:GetService("RunService").RenderStepped:Connect(function()
            if speedEnabled and humanoid and humanoid.Parent then
                if humanoid.WalkSpeed ~= speedValue then
                    humanoid.WalkSpeed = speedValue
                end
            end
        end)
    else
        -- 속도핵 끄기: 원래 속도로 복구
        if speedConnection then
            speedConnection:Disconnect()
            speedConnection = nil
        end
        
        if humanoid and humanoid.Parent then
            humanoid.WalkSpeed = originalWalkSpeed
        end
    end
end

-- 메인 탭에 속도핵 UI 구성
local speedSection = MainTab:CreateSection("속도핵")

-- 1. 속도핵 켜기/끄기 토글
local speedToggle = MainTab:CreateToggle({
    Name = "속도핵 켜기",
    CurrentValue = false,
    Flag = "SpeedToggle",
    Callback = function(Value)
        speedEnabled = Value
        setupSpeed()
        
        if Value then
            Rayfield:Notify({
                Title = "속도핵",
                Content = "활성화되었습니다. (속도: " .. speedValue .. ")",
                Duration = 2
            })
        else
            Rayfield:Notify({
                Title = "속도핵",
                Content = "비활성화되었습니다.",
                Duration = 2
            })
        end
    end
})

-- 2. 현재 속도 표시 (라벨)
local currentSpeedLabel = MainTab:CreateLabel("현재 속도: 50")

-- 3. 속도 조절 슬라이더 (1 ~ 1000)
local speedSlider = MainTab:CreateSlider({
    Name = "속도 조절",
    Range = {1, 1000},
    Increment = 1,
    Suffix = "속도",
    CurrentValue = 50,
    Flag = "SpeedSlider",
    Callback = function(Value)
        speedValue = Value
        
        -- 현재 속도 라벨 업데이트
        if currentSpeedLabel then
            currentSpeedLabel:Set("현재 속도: " .. Value)
        end
        
        -- 속도핵이 켜져 있으면 즉시 속도 적용
        if speedEnabled then
            local player = game.Players.LocalPlayer
            local character = player.Character
            if character then
                local humanoid = character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.WalkSpeed = Value
                end
            end
        end
    end
})

-- 캐릭터 변경 시 처리 (리스폰 등)
game.Players.LocalPlayer.CharacterAdded:Connect(function(character)
    wait(1)
    
    local humanoid = character:WaitForChild("Humanoid", 5)
    if not humanoid then return end
    
    -- 원래 속도 저장
    originalWalkSpeed = 16
    
    -- 속도핵이 켜져 있으면 다시 적용
    if speedEnabled then
        wait(0.2)
        humanoid.WalkSpeed = speedValue
        setupSpeed() -- 연결도 다시 설정
    end
end)

-- 초기화 완료 알림
Rayfield:Notify({
    Title = "동혁이 쓰려고 만든 핵",
    Content = "메인 탭 - 속도핵이 로드되었습니다. (키 없음)",
    Duration = 3
})
