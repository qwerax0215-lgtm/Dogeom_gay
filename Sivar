--[[
    ìœ ë‹ˆë²„ìŠ¤ (Universe) - Rayfield GUI (ìµœì¢… ì™„ì„±íŒ)
    - ëª¨ë“  ì˜¤ë¥˜ ìˆ˜ì •
    - ë²”ìœ„ ëŒ€í­ í™•ëŒ€ (1~5000)
    - ì¤‘ë ¥ ì¡°ì ˆ ì¶”ê°€
    - í”Œë¼ì´ (í•˜ëŠ˜ ë‚ ê¸°) ì¶”ê°€
]]

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- ìœˆë„ìš° ìƒì„±
local Window = Rayfield:CreateWindow({
    Name = "ìœ ë‹ˆë²„ìŠ¤ (Universe)",
    LoadingTitle = "ìœ ë‹ˆë²„ìŠ¤ ë¡œë”© ì¤‘...",
    LoadingSubtitle = "by Rayfield",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "UniverseHub",
        FileName = "Config"
    },
    ToggleUIKeybind = "K",
    KeySystem = false,
})

--============================================================================--
-- ì „ì—­ ë³€ìˆ˜ ì„¤ì •
--============================================================================--
local player = game.Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

-- ìºë¦­í„°ê°€ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” í•¨ìˆ˜
local function waitForCharacter()
    repeat wait() until player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    return player.Character
end

--============================================================================--
-- 1. ë©”ì¸ íƒ­ (í•µì‹¬ ê¸°ëŠ¥)
--============================================================================--
local MainTab = Window:CreateTab("ë©”ì¸", 4483362458)
local MainSection = MainTab:CreateSection("ì´ë™ ê´€ë ¨ ê¸°ëŠ¥")

-- í™˜ì˜ ë©”ì‹œì§€
Rayfield:Notify({
    Title = "ìœ ë‹ˆë²„ìŠ¤ ì‹¤í–‰ë¨",
    Content = "Kí‚¤ë¥¼ ëˆŒëŸ¬ UIë¥¼ í† ê¸€í•˜ì„¸ìš”.",
    Duration = 5,
})

------------------------------------------------------------------------
-- 1.1 ì†ë„ ì¡°ì ˆ ìŠ¬ë¼ì´ë” (1~5000, ì™„ì „ ê°œì„ )
------------------------------------------------------------------------
local currentSpeed = 16
local speedHumanoid = nil
local speedConnection = nil

-- ì†ë„ ì ìš© í•¨ìˆ˜ (ì™„ì „ ì•ˆì •ì )
local function applySpeed(speedValue)
    local success, err = pcall(function()
        if player and player.Character then
            local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = speedValue
                return true
            end
        end
    end)
    return false
end

-- ì†ë„ ìŠ¬ë¼ì´ë” ìƒì„± (1~5000)
local speedSlider = MainTab:CreateSlider({
    Name = "ì†ë„ ì¡°ì ˆ (WalkSpeed) - 1~5000",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Flag = "SpeedSlider",
    Callback = function(value)
        currentSpeed = value
        applySpeed(value)
    end,
})

-- í˜„ì¬ ì†ë„ í‘œì‹œ ë ˆì´ë¸”
local speedLabel = MainTab:CreateLabel("í˜„ì¬ ì†ë„: 16")

-- ì†ë„ ì‹¤ì‹œê°„ í‘œì‹œ ë° ê°•ì œ ìœ ì§€
RunService.Heartbeat:Connect(function()
    if player and player.Character then
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            local currentWS = humanoid.WalkSpeed
            speedLabel:Set("í˜„ì¬ ì†ë„: " .. math.floor(currentWS))
            
            -- ì†ë„ê°€ ì„¤ì •ê°’ê³¼ ë‹¤ë¥´ë©´ ê°•ì œë¡œ ë³€ê²½
            if currentWS ~= currentSpeed and currentSpeed > 0 then
                humanoid.WalkSpeed = currentSpeed
            end
        end
    end
end)

-- ìºë¦­í„° ë¦¬ìŠ¤í° ì²˜ë¦¬
local function onCharacterAdded(character)
    -- ìºë¦­í„°ê°€ ì™„ì „íˆ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
    local humanoid = character:WaitForChild("Humanoid", 10)
    if humanoid then
        -- ì—¬ëŸ¬ ë²ˆ ì‹œë„í•˜ì—¬ ì†ë„ ì ìš©
        for i = 1, 5 do
            task.wait(0.5)
            pcall(function()
                humanoid.WalkSpeed = currentSpeed
            end)
        end
    end
end

player.CharacterAdded:Connect(onCharacterAdded)

-- ì´ˆê¸° ìºë¦­í„° ì²˜ë¦¬
if player.Character then
    onCharacterAdded(player.Character)
end

------------------------------------------------------------------------
-- 1.2 ì í”„ë ¥ ì¡°ì ˆ (1~5000)
------------------------------------------------------------------------
local currentJumpPower = 50

MainTab:CreateSlider({
    Name = "ì í”„ë ¥ ì¡°ì ˆ (JumpPower) - 1~5000",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "Power",
    CurrentValue = 50,
    Flag = "JumpSlider",
    Callback = function(value)
        currentJumpPower = value
        if player and player.Character then
            local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = value
            end
        end
    end,
})

-- ì í”„ë ¥ ì‹¤ì‹œê°„ í‘œì‹œ
local jumpLabel = MainTab:CreateLabel("í˜„ì¬ ì í”„ë ¥: 50")

RunService.Heartbeat:Connect(function()
    if player and player.Character then
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            local currentJP = humanoid.JumpPower
            jumpLabel:Set("í˜„ì¬ ì í”„ë ¥: " .. math.floor(currentJP))
        end
    end
end)

------------------------------------------------------------------------
-- 1.3 ì¤‘ë ¥ ì¡°ì ˆ (1~5000) - ìƒˆ ê¸°ëŠ¥
------------------------------------------------------------------------
local currentGravity = 196.2  -- ê¸°ë³¸ ë¡œë¸”ë¡ìŠ¤ ì¤‘ë ¥

-- ì¤‘ë ¥ ì ìš© í•¨ìˆ˜
local function applyGravity(value)
    workspace.Gravity = value
    currentGravity = value
end

MainTab:CreateSlider({
    Name = "ì¤‘ë ¥ ì¡°ì ˆ (Gravity) - 1~5000",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "Gravity",
    CurrentValue = 196.2,
    Flag = "GravitySlider",
    Callback = function(value)
        applyGravity(value)
    end,
})

-- í˜„ì¬ ì¤‘ë ¥ í‘œì‹œ
local gravityLabel = MainTab:CreateLabel("í˜„ì¬ ì¤‘ë ¥: 196.2")

RunService.Heartbeat:Connect(function()
    gravityLabel:Set("í˜„ì¬ ì¤‘ë ¥: " .. math.floor(workspace.Gravity))
end)

------------------------------------------------------------------------
-- 1.4 í”Œë¼ì´ (í•˜ëŠ˜ ë‚ ê¸°) ê¸°ëŠ¥ - ìƒˆ ê¸°ëŠ¥
------------------------------------------------------------------------
local FlySection = MainTab:CreateSection("í”Œë¼ì´ (í•˜ëŠ˜ ë‚ ê¸°)")

local flyEnabled = false
local flySpeed = 50
local flyConnection = nil
local flyBodyVelocity = nil
local flyBodyGyro = nil

-- í”Œë¼ì´ ì†ë„ ìŠ¬ë¼ì´ë” (1~5000)
MainTab:CreateSlider({
    Name = "í”Œë¼ì´ ì†ë„ - 1~5000",
    Range = {1, 5000},
    Increment = 1,
    Suffix = "Fly Speed",
    CurrentValue = 50,
    Flag = "FlySpeedSlider",
    Callback = function(value)
        flySpeed = value
        if flyBodyVelocity then
            flyBodyVelocity.MaxForce = Vector3.new(value * 1000, value * 1000, value * 1000)
        end
    end,
})

-- í”Œë¼ì´ í† ê¸€
MainTab:CreateToggle({
    Name = "í”Œë¼ì´ (í•˜ëŠ˜ ë‚ ê¸°) ON/OFF",
    CurrentValue = false,
    Flag = "FlyToggle",
    Callback = function(state)
        flyEnabled = state
        
        if flyEnabled then
            -- í”Œë¼ì´ í™œì„±í™”
            local character = player.Character
            if not character then
                character = waitForCharacter()
            end
            
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            
            if not rootPart or not humanoid then
                Rayfield:Notify({ Title = "ì˜¤ë¥˜", Content = "ìºë¦­í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ", Duration = 2 })
                return
            end
            
            -- ê¸°ì¡´ í”Œë¼ì´ ì¸ìŠ¤í„´ìŠ¤ ì œê±°
            if flyBodyVelocity then
                flyBodyVelocity:Destroy()
                flyBodyVelocity = nil
            end
            if flyBodyGyro then
                flyBodyGyro:Destroy()
                flyBodyGyro = nil
            end
            
            -- BodyVelocity ìƒì„± (ì´ë™ìš©)
            flyBodyVelocity = Instance.new("BodyVelocity")
            flyBodyVelocity.Velocity = Vector3.new(0, 0, 0)
            flyBodyVelocity.MaxForce = Vector3.new(flySpeed * 1000, flySpeed * 1000, flySpeed * 1000)
            flyBodyVelocity.P = 10000
            flyBodyVelocity.Parent = rootPart
            
            -- BodyGyro ìƒì„± (ë°©í–¥ ê³ ì •)
            flyBodyGyro = Instance.new("BodyGyro")
            flyBodyGyro.MaxTorque = Vector3.new(40000, 40000, 40000)
            flyBodyGyro.P = 10000
            flyBodyGyro.CFrame = rootPart.CFrame
            flyBodyGyro.Parent = rootPart
            
            -- ì¤‘ë ¥ ì˜í–¥ ì œê±°
            humanoid.PlatformStand = true
            
            -- í”Œë¼ì´ ì—…ë°ì´íŠ¸ ë£¨í”„
            flyConnection = RunService.Heartbeat:Connect(function()
                if not flyEnabled or not player.Character or not rootPart or not flyBodyVelocity then
                    return
                end
                
                -- í‚¤ë³´ë“œ ì…ë ¥ì— ë”°ë¥¸ ì´ë™ ë°©í–¥ ê³„ì‚°
                local moveDirection = Vector3.new(0, 0, 0)
                local camera = workspace.CurrentCamera
                
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                    moveDirection = moveDirection + camera.CFrame.LookVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                    moveDirection = moveDirection - camera.CFrame.LookVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                    moveDirection = moveDirection - camera.CFrame.RightVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                    moveDirection = moveDirection + camera.CFrame.RightVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                    moveDirection = moveDirection + Vector3.new(0, 1, 0)
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
                    moveDirection = moveDirection + Vector3.new(0, -1, 0)
                end
                
                -- ì´ë™ ë°©í–¥ ì •ê·œí™” ë° ì†ë„ ì ìš©
                if moveDirection.Magnitude > 0 then
                    moveDirection = moveDirection.Unit * flySpeed
                end
                
                flyBodyVelocity.Velocity = moveDirection
                flyBodyGyro.CFrame = camera.CFrame
            end)
            
            Rayfield:Notify({ Title = "í”Œë¼ì´", Content = "í™œì„±í™”ë¨ (WASD=ì´ë™, ìŠ¤í˜ì´ìŠ¤=ìƒìŠ¹, Ctrl=í•˜ê°•)", Duration = 3 })
        else
            -- í”Œë¼ì´ ë¹„í™œì„±í™”
            if flyConnection then
                flyConnection:Disconnect()
                flyConnection = nil
            end
            
            if flyBodyVelocity then
                flyBodyVelocity:Destroy()
                flyBodyVelocity = nil
            end
            
            if flyBodyGyro then
                flyBodyGyro:Destroy()
                flyBodyGyro = nil
            end
            
            if player.Character then
                local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.PlatformStand = false
                end
            end
            
            Rayfield:Notify({ Title = "í”Œë¼ì´", Content = "ë¹„í™œì„±í™”ë¨", Duration = 2 })
        end
    end,
})

-- í”Œë¼ì´ ìƒíƒœ í‘œì‹œ
local flyStatusLabel = MainTab:CreateLabel("í”Œë¼ì´ ìƒíƒœ: êº¼ì§")

RunService.Heartbeat:Connect(function()
    flyStatusLabel:Set("í”Œë¼ì´ ìƒíƒœ: " .. (flyEnabled and "ì¼œì§ (ì†ë„: " .. flySpeed .. ")" or "êº¼ì§"))
end)

-- ìºë¦­í„° ë¦¬ìŠ¤í° ì‹œ í”Œë¼ì´ ì²˜ë¦¬
player.CharacterAdded:Connect(function(character)
    if flyEnabled then
        -- ì ì‹œ í›„ í”Œë¼ì´ ì¬í™œì„±í™”
        task.wait(1)
        if flyEnabled then
            -- í† ê¸€ì„ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ í”Œë¼ì´ ì¬ì„¤ì •
            flyEnabled = false
            -- ì•½ê°„ì˜ ì§€ì—° í›„ ë‹¤ì‹œ ì¼œê¸°
            task.wait(0.1)
            -- ì‹¤ì œë¡œëŠ” í† ê¸€ì„ ë‹¤ì‹œ ì¼œì•¼ í•˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ìë™ìœ¼ë¡œ ì²˜ë¦¬
            -- ë³µì¡í•˜ë‹ˆ ì‚¬ìš©ìê°€ ì§ì ‘ í† ê¸€ì„ ê»ë‹¤ ì¼œë„ë¡ ì•ˆë‚´
            Rayfield:Notify({ 
                Title = "ì•Œë¦¼", 
                Content = "ìºë¦­í„°ê°€ ë¦¬ìŠ¤í°ë˜ì—ˆìŠµë‹ˆë‹¤. í”Œë¼ì´ë¥¼ ë‹¤ì‹œ ì¼œì£¼ì„¸ìš”.", 
                Duration = 3 
            })
        end
    end
end)

------------------------------------------------------------------------
-- 1.5 ë¬´í•œ ì í”„
------------------------------------------------------------------------
local InfiniteJumpEnabled = false
local JumpConnection = nil

MainTab:CreateToggle({
    Name = "ë¬´í•œ ì í”„",
    CurrentValue = false,
    Flag = "InfiniteJumpToggle",
    Callback = function(state)
        InfiniteJumpEnabled = state

        if InfiniteJumpEnabled then
            JumpConnection = UIS.JumpRequest:Connect(function()
                if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
                    player.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                end
            end)
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë¬´í•œ ì í”„ ON", Duration = 2 })
        else
            if JumpConnection then
                JumpConnection:Disconnect()
                JumpConnection = nil
            end
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë¬´í•œ ì í”„ OFF", Duration = 2 })
        end
    end,
})

------------------------------------------------------------------------
-- 1.6 ë²½ëš«ê¸° (Noclip)
------------------------------------------------------------------------
local NoclipEnabled = false
local NoclipConnection = nil

MainTab:CreateToggle({
    Name = "ë²½ëš«ê¸° (Noclip)",
    CurrentValue = false,
    Flag = "NoclipToggle",
    Callback = function(state)
        NoclipEnabled = state

        if NoclipEnabled then
            NoclipConnection = RunService.Stepped:Connect(function()
                if player.Character then
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") and part.CanCollide == true then
                            part.CanCollide = false
                        end
                    end
                end
            end)
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë²½ëš«ê¸° ON", Duration = 2 })
        else
            if NoclipConnection then
                NoclipConnection:Disconnect()
                NoclipConnection = nil
                
                if player.Character then
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = true
                        end
                    end
                end
            end
            Rayfield:Notify({ Title = "ë©”ì¸", Content = "ë²½ëš«ê¸° OFF", Duration = 2 })
        end
    end,
})

------------------------------------------------------------------------
-- 1.7 PCLD - ìƒëŒ€ë°© ìœ„ì¹˜ ID í‘œì‹œ
------------------------------------------------------------------------
local PCLDSection = MainTab:CreateSection("PCLD - ìƒëŒ€ë°© ID í‘œì‹œ")

local PCLDEnabled = false
local PCLDMarkers = {}
local PCLDConnection = nil

-- ID ë§ˆì»¤ ìƒì„± í•¨ìˆ˜
local function createIDMarker(targetPlayer)
    if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        return nil
    end
    
    local marker = Instance.new("Part")
    marker.Name = "PCLD_Marker_" .. targetPlayer.Name
    marker.Size = Vector3.new(1, 1, 1)
    marker.Transparency = 1
    marker.Anchored = true
    marker.CanCollide = false
    marker.Parent = workspace
    
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "IDTag"
    billboard.Size = UDim2.new(0, 150, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = marker
    
    local background = Instance.new("Frame")
    background.Size = UDim2.new(1, 0, 1, 0)
    background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    background.BackgroundTransparency = 0.3
    background.BorderSizePixel = 2
    background.BorderColor3 = Color3.fromRGB(255, 100, 100)
    background.Parent = billboard
    
    local idLabel = Instance.new("TextLabel")
    idLabel.Size = UDim2.new(1, 0, 0.5, 0)
    idLabel.Position = UDim2.new(0, 0, 0, 0)
    idLabel.BackgroundTransparency = 1
    idLabel.Text = "ID: " .. targetPlayer.UserId
    idLabel.TextColor3 = Color3.fromRGB(255, 200, 200)
    idLabel.TextStrokeTransparency = 0.3
    idLabel.TextStrokeColor3 = Color3.fromRGB(255, 0, 0)
    idLabel.Font = Enum.Font.GothamBold
    idLabel.TextSize = 18
    idLabel.Parent = background
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    nameLabel.Position = UDim2.new(0, 0, 0.5, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = targetPlayer.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextStrokeTransparency = 0
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.Font = Enum.Font.Gotham
    nameLabel.TextSize = 14
    nameLabel.Parent = background
    
    return marker
end

local function updatePCLDMarkers()
    for _, marker in pairs(PCLDMarkers) do
        if marker then
            pcall(function() marker:Destroy() end)
        end
    end
    PCLDMarkers = {}
    
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then
            local success, marker = pcall(function() return createIDMarker(plr) end)
            if success and marker then
                PCLDMarkers[plr] = marker
            end
        end
    end
end

local function moveMarkersToPlayers()
    for plr, marker in pairs(PCLDMarkers) do
        local success, result = pcall(function()
            if plr and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                marker.CFrame = plr.Character.HumanoidRootPart.CFrame
                return true
            end
        end)
        
        if not success or not result then
            if marker then
                pcall(function() marker:Destroy() end)
            end
            PCLDMarkers[plr] = nil
        end
    end
    
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player and not PCLDMarkers[plr] then
            local success, marker = pcall(function() return createIDMarker(plr) end)
            if success and marker then
                PCLDMarkers[plr] = marker
            end
        end
    end
end

MainTab:CreateToggle({
    Name = "PCLD - ìƒëŒ€ë°© ID í‘œì‹œ",
    CurrentValue = false,
    Flag = "PCLDToggle",
    Callback = function(state)
        PCLDEnabled = state
        
        if PCLDEnabled then
            pcall(updatePCLDMarkers)
            
            PCLDConnection = RunService.Heartbeat:Connect(function()
                if PCLDEnabled then
                    pcall(moveMarkersToPlayers)
                end
            end)
            
            Rayfield:Notify({ Title = "PCLD", Content = "ìƒëŒ€ë°© ID í‘œì‹œ ON", Duration = 2 })
        else
            if PCLDConnection then
                PCLDConnection:Disconnect()
                PCLDConnection = nil
            end
            
            for _, marker in pairs(PCLDMarkers) do
                pcall(function() marker:Destroy() end)
            end
            PCLDMarkers = {}
            
            Rayfield:Notify({ Title = "PCLD", Content = "ìƒëŒ€ë°© ID í‘œì‹œ OFF", Duration = 2 })
        end
    end,
})

--============================================================================--
-- 2. í…”ë ˆí¬íŠ¸ íƒ­ (ì™„ì „ ìˆ˜ì • - í”Œë ˆì´ì–´ ì„ íƒ ì˜¤ë¥˜ í•´ê²°)
--============================================================================--
local TeleportTab = Window:CreateTab("í…”ë ˆí¬íŠ¸", 4483362458)
local TeleportSection = TeleportTab:CreateSection("í”Œë ˆì´ì–´ì—ê²Œ í…”ë ˆí¬íŠ¸ (1ì´ˆ ë”œë ˆì´)")

-- í”Œë ˆì´ì–´ ì„ íƒì„ ìœ„í•œ ë³€ìˆ˜
local selectedPlayer = nil
local playerList = {}
local isTeleporting = false

-- í”Œë ˆì´ì–´ ëª©ë¡ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ì•ˆì „í•˜ê²Œ)
local function updatePlayerList()
    local newList = {}
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then
            table.insert(newList, plr.Name)
        end
    end
    return newList
end

-- í”Œë ˆì´ì–´ ì„ íƒ ë“œë¡­ë‹¤ìš´ (ìˆ˜ì •ë¨)
local playerDropdown = TeleportTab:CreateDropdown({
    Name = "í”Œë ˆì´ì–´ ì„ íƒ",
    Options = updatePlayerList(),
    CurrentOption = {"ì„ íƒí•˜ì„¸ìš”"},
    MultipleOptions = false,
    Flag = "PlayerSelectDropdown",
    Callback = function(selected)
        -- ì„ íƒëœ í”Œë ˆì´ì–´ ì°¾ê¸°
        if selected and #selected > 0 then
            local selectedName = selected[1]
            for _, plr in ipairs(Players:GetPlayers()) do
                if plr.Name == selectedName then
                    selectedPlayer = plr
                    Rayfield:Notify({
                        Title = "í”Œë ˆì´ì–´ ì„ íƒ",
                        Content = plr.Name .. " ë‹˜ì´ ì„ íƒë¨ (ID: " .. plr.UserId .. ")",
                        Duration = 2
                    })
                    break
                end
            end
        end
    end,
})

-- ìƒíƒœ í‘œì‹œ ë ˆì´ë¸”
local statusLabel = TeleportTab:CreateLabel("ìƒíƒœ: ëŒ€ê¸° ì¤‘")

-- í…”ë ˆí¬íŠ¸ í•¨ìˆ˜ (1ì´ˆ ë”œë ˆì´)
local function teleportToPlayer(targetPlayer)
    if isTeleporting then
        Rayfield:Notify({
            Title = "ê²½ê³ ",
            Content = "ì´ë¯¸ í…”ë ˆí¬íŠ¸ ì¤‘ì…ë‹ˆë‹¤!",
            Duration = 2
        })
        return
    end
    
    if not targetPlayer then
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = "ë¨¼ì € í”Œë ˆì´ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”!",
            Duration = 2
        })
        return
    end
    
    -- ëŒ€ìƒ í”Œë ˆì´ì–´ í™•ì¸
    local targetExists = false
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr == targetPlayer then
            targetExists = true
            break
        end
    end
    
    if not targetExists then
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = "ì„ íƒí•œ í”Œë ˆì´ì–´ê°€ ê²Œì„ì— ì—†ìŠµë‹ˆë‹¤.",
            Duration = 2
        })
        selectedPlayer = nil
        return
    end
    
    -- ëŒ€ìƒ ìºë¦­í„° í™•ì¸
    if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = targetPlayer.Name .. "ë‹˜ì˜ ìºë¦­í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
            Duration = 2
        })
        return
    end
    
    -- ë‚´ ìºë¦­í„° í™•ì¸
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = "ë‚´ ìºë¦­í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.",
            Duration = 2
        })
        return
    end
    
    -- í…”ë ˆí¬íŠ¸ ì‹œì‘
    isTeleporting = true
    statusLabel:Set("ìƒíƒœ: í…”ë ˆí¬íŠ¸ ì¤€ë¹„ì¤‘...")
    
    -- 1ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´
    for i = 1, 10 do
        local countdownValue = (11 - i) / 10
        statusLabel:Set("ìƒíƒœ: " .. string.format("%.1f", countdownValue) .. "ì´ˆ í›„ í…”ë ˆí¬íŠ¸...")
        
        -- í™”ë©´ í”ë“¤ë¦¼ íš¨ê³¼
        pcall(function()
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local randomOffset = Vector3.new(
                    math.random(-20, 20) / 10,
                    math.random(-20, 20) / 10,
                    math.random(-20, 20) / 10
                )
                player.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame + randomOffset
            end
        end)
        
        task.wait(0.1)
    end
    
    -- í…”ë ˆí¬íŠ¸ ì‹¤í–‰
    local success = pcall(function()
        if targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local targetCF = targetPlayer.Character.HumanoidRootPart.CFrame
            player.Character.HumanoidRootPart.CFrame = targetCF + Vector3.new(0, 5, 0)
            
            -- íš¨ê³¼ íŒŒí‹°í´
            local effect = Instance.new("Part")
            effect.Size = Vector3.new(3, 3, 3)
            effect.Position = player.Character.HumanoidRootPart.Position
            effect.BrickColor = BrickColor.new("Bright blue")
            effect.Material = Enum.Material.Neon
            effect.Transparency = 0.3
            effect.Anchored = true
            effect.CanCollide = false
            effect.Parent = workspace
            
            -- ì„œì„œíˆ ì‚¬ë¼ì§
            for i = 1, 10 do
                effect.Transparency = effect.Transparency + 0.07
                effect.Size = effect.Size + Vector3.new(0.3, 0.3, 0.3)
                task.wait(0.03)
            end
            effect:Destroy()
            
            return true
        end
        return false
    end)
    
    if success then
        Rayfield:Notify({
            Title = "í…”ë ˆí¬íŠ¸ ì™„ë£Œ!",
            Content = targetPlayer.Name .. "ë‹˜ì—ê²Œ ì´ë™í–ˆìŠµë‹ˆë‹¤.",
            Duration = 3
        })
    else
        Rayfield:Notify({
            Title = "ì˜¤ë¥˜",
            Content = "í…”ë ˆí¬íŠ¸ ì‹¤íŒ¨",
            Duration = 2
        })
    end
    
    statusLabel:Set("ìƒíƒœ: ëŒ€ê¸° ì¤‘")
    isTeleporting = false
end

-- í…”ë ˆí¬íŠ¸ ë²„íŠ¼
TeleportTab:CreateButton({
    Name = "ğŸ¯ ì„ íƒí•œ í”Œë ˆì´ì–´ì—ê²Œ í…”ë ˆí¬íŠ¸ (1ì´ˆ í›„ ì´ë™)",
    Callback = function()
        teleportToPlayer(selectedPlayer)
    end,
})

-- T í‚¤ ë‹¨ì¶•í‚¤
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.T then
        if selectedPlayer then
            teleportToPlayer(selectedPlayer)
        else
            Rayfield:Notify({
                Title = "ì•Œë¦¼",
                Content = "ë¨¼ì € í”Œë ˆì´ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”!",
                Duration = 2
            })
        end
    end
end)

-- í”Œë ˆì´ì–´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
TeleportTab:CreateButton({
    Name = "ğŸ”„ í”Œë ˆì´ì–´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨",
    Callback = function()
        local newOptions = updatePlayerList()
        playerDropdown:Set(newOptions)
        
        -- ì„ íƒëœ í”Œë ˆì´ì–´ê°€ ì—¬ì „íˆ ìˆëŠ”ì§€ í™•ì¸
        if selectedPlayer then
            local stillExists = false
            for _, plr in ipairs(Players:GetPlayers()) do
                if plr == selectedPlayer then
                    stillExists = true
                    break
                end
            end
            if not stillExists then
                selectedPlayer = nil
            end
        end
        
        Rayfield:Notify({
            Title = "ê°±ì‹  ì™„ë£Œ",
            Content = "í”Œë ˆì´ì–´ ëª©ë¡ì´ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤. (" .. #newOptions .. "ëª…)",
            Duration = 2
        })
    end,
})

-- ì„ íƒëœ í”Œë ˆì´ì–´ ì •ë³´ í‘œì‹œ
local selectedInfoLabel = TeleportTab:CreateLabel("ì„ íƒëœ í”Œë ˆì´ì–´: ì—†ìŒ")

RunService.Heartbeat:Connect(function()
    if selectedPlayer then
        local info = "ì„ íƒë¨: " .. selectedPlayer.Name
        pcall(function()
            if selectedPlayer.Character and selectedPlayer.Character:FindFirstChild("HumanoidRootPart") and
               player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local pos = selectedPlayer.Character.HumanoidRootPart.Position
                local myPos = player.Character.HumanoidRootPart.Position
                local dist = (myPos - pos).Magnitude
                info = info .. string.format(" (ê±°ë¦¬: %.1f)", dist)
            end
        end)
        selectedInfoLabel:Set(info)
    else
        selectedInfoLabel:Set("ì„ íƒëœ í”Œë ˆì´ì–´: ì—†ìŒ")
    end
end)

--============================================================================--
-- 2.2 ì¼ë°˜ í…”ë ˆí¬íŠ¸ ê¸°ëŠ¥
--============================================================================--
local GeneralTPSection = TeleportTab:CreateSection("ì¼ë°˜ ìœ„ì¹˜ ì´ë™")

local function findSpawnLocation()
    local spawnCandidates = {
        workspace:FindFirstChild("SpawnLocation"),
        workspace:FindFirstChild("Spawn"),
        workspace:FindFirstChild("Start"),
        workspace:FindFirstChild("Baseplate")
    }
    
    for _, spawn in pairs(spawnCandidates) do
        if spawn and spawn:IsA("BasePart") then
            return spawn
        end
    end
    return nil
end

TeleportTab:CreateButton({
    Name = "ìŠ¤í° ì§€ì—­ìœ¼ë¡œ ì´ë™",
    Callback = function()
        pcall(function()
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local spawnLocation = findSpawnLocation()
                if spawnLocation then
                    player.Character.HumanoidRootPart.CFrame = spawnLocation.CFrame + Vector3.new(0, 3, 0)
                    Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "ìŠ¤í° ì§€ì—­ìœ¼ë¡œ ì´ë™ë¨", Duration = 2 })
                else
                    player.Character.HumanoidRootPart.CFrame = CFrame.new(0, 10, 0)
                    Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "ìŠ¤í° ì—†ìŒ, 0,0,0 ì¢Œí‘œë¡œ ì´ë™", Duration = 2 })
                end
            end
        end)
    end,
})

TeleportTab:CreateButton({
    Name = "í•˜ëŠ˜ë¡œ ì´ë™ (Y 500)",
    Callback = function()
        pcall(function()
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local currentPos = player.Character.HumanoidRootPart.Position
                player.Character.HumanoidRootPart.CFrame = CFrame.new(currentPos.X, 500, currentPos.Z)
                Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "í•˜ëŠ˜ë¡œ ì´ë™ë¨", Duration = 2 })
            end
        end)
    end,
})

TeleportTab:CreateButton({
    Name = "ë•…ìœ¼ë¡œ ì´ë™ (Y 0)",
    Callback = function()
        pcall(function()
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local currentPos = player.Character.HumanoidRootPart.Position
                player.Character.HumanoidRootPart.CFrame = CFrame.new(currentPos.X, 5, currentPos.Z)
                Rayfield:Notify({ Title = "í…”ë ˆí¬íŠ¸", Content = "ë•…ìœ¼ë¡œ ì´ë™ë¨", Duration = 2 })
            end
        end)
    end,
})

--============================================================================--
-- 3. ê·¸ ì™¸ íƒ­
--============================================================================--
local MiscTab = Window:CreateTab("ê·¸ ì™¸", 4483362458)
local MiscSection = MiscTab:CreateSection("ê¸°íƒ€ ì„¤ì •")

MiscTab:CreateButton({
    Name = "UI ì™„ì „ ì¢…ë£Œ",
    Callback = function()
        Rayfield:Destroy()
    end,
})

MiscTab:CreateButton({
    Name = "ìºë¦­í„° ë¦¬ì…‹ (ì£½ì´ê¸°)",
    Callback = function()
        pcall(function()
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid.Health = 0
                Rayfield:Notify({ Title = "ê·¸ ì™¸", Content = "ìºë¦­í„° ë¦¬ì…‹ë¨", Duration = 2 })
            end
        end)
    end,
})

MiscTab:CreateButton({
    Name = "FPS ë¶€ìŠ¤íŠ¸",
    Callback = function()
        pcall(function()
            settings().Rendering.QualityLevel = 1
            game:GetService("RunService"):Set3dRenderingEnabled(false)
            wait(0.1)
            game:GetService("RunService"):Set3dRenderingEnabled(true)
            
            Rayfield:Notify({ Title = "ê·¸ ì™¸", Content = "FPS ë¶€ìŠ¤íŠ¸ ì ìš©ë¨", Duration = 2 })
        end)
    end,
})
